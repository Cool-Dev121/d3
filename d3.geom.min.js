(function(){function D(c,h,f,a){var i,b,j;c=a[c];i=c[0];b=c[1];c=a[h];h=c[0];j=c[1];c=a[f];return(c[1]-b)*(h-i)-(j-b)*(c[0]-i)>0}function z(c,h,f){return(f[0]-h[0])*(c[1]-h[1])<(f[1]-h[1])*(c[0]-h[0])}function B(c,h,f,a){var i=c[0],b=f[0];c=c[1];var j=f[1];f=h[0]-i;var m=a[0]-b;h=h[1]-c;a=a[1]-j;b=(m*(c-j)-a*(i-b))/(a*f-m*h);return[i+b*f,c+b*h]}function C(c,h){var f={list:c.map(function(d,g){return{index:g,x:d[0],y:d[1]}}).sort(function(d,g){return d.y<g.y?-1:d.y>g.y?1:d.x<g.x?-1:d.x>g.x?1:0}),bottomSite:null},
a={list:[],leftEnd:null,rightEnd:null,init:function(){a.leftEnd=a.createHalfEdge(null,"l");a.rightEnd=a.createHalfEdge(null,"l");a.leftEnd.r=a.rightEnd;a.rightEnd.l=a.leftEnd;a.list.unshift(a.leftEnd,a.rightEnd)},createHalfEdge:function(d,g){return{edge:d,side:g,vertex:null,l:null,r:null}},insert:function(d,g){g.l=d;g.r=d.r;d.r.l=g;d.r=g},leftBound:function(d){var g=a.leftEnd;do g=g.r;while(g!=a.rightEnd&&i.rightOf(g,d));return g=g.l},del:function(d){d.l.r=d.r;d.r.l=d.l;d.edge=null},right:function(d){return d.r},
left:function(d){return d.l},leftRegion:function(d){return d.edge==null?f.bottomSite:d.edge.region[d.side]},rightRegion:function(d){return d.edge==null?f.bottomSite:d.edge.region[A[d.side]]}},i={bisect:function(d,g){var e={region:{l:d,r:g},ep:{l:null,r:null}},l=g.x-d.x,o=g.y-d.y,t=l>0?l:-l,s=o>0?o:-o;e.c=d.x*l+d.y*o+(l*l+o*o)*0.5;if(t>s){e.a=1;e.b=o/l;e.c/=l}else{e.b=1;e.a=l/o;e.c/=o}return e},intersect:function(d,g){var e=d.edge,l=g.edge;if(!e||!l||e.region.r==l.region.r)return null;var o=e.a*l.b-
e.b*l.a;if(Math.abs(o)<1.0E-10)return null;var t=(e.c*l.b-l.c*e.b)/o;o=(l.c*e.a-e.c*l.a)/o;var s=e.region.r,y=l.region.r;if(s.y<y.y||s.y==y.y&&s.x<y.x){s=d;e=e}else{s=g;e=l}if((e=t>=e.region.r.x)&&s.side=="l"||!e&&s.side=="r")return null;return{x:t,y:o}},rightOf:function(d,g){var e=d.edge,l=e.region.r,o=g.x>l.x;if(o&&d.side=="l")return 1;if(!o&&d.side=="r")return 0;if(e.a==1){var t=g.y-l.y,s=g.x-l.x,y=0,v=0;if(!o&&e.b<0||o&&e.b>=0)v=y=t>=e.b*s;else{v=g.x+g.y*e.b>e.c;if(e.b<0)v=!v;v||(y=1)}if(!y){l=
l.x-e.region.l.x;v=e.b*(s*s-t*t)<l*t*(1+2*s/l+e.b*e.b);if(e.b<0)v=!v}}else{s=e.c-e.a*g.x;e=g.y-s;t=g.x-l.x;l=s-l.y;v=e*e>t*t+l*l}return d.side=="l"?v:!v},endPoint:function(d,g,e){d.ep[g]=e;d.ep[A[g]]&&h(d)},distance:function(d,g){var e=d.x-g.x,l=d.y-g.y;return Math.sqrt(e*e+l*l)}},b={list:[],insert:function(d,g,e){d.vertex=g;d.ystar=g.y+e;e=0;for(var l=b.list,o=l.length;e<o;e++){var t=l[e];if(!(d.ystar>t.ystar||d.ystar==t.ystar&&g.x>t.vertex.x))break}l.splice(e,0,d)},del:function(d){for(var g=0,e=
b.list,l=e.length;g<l&&e[g]!=d;++g);e.splice(g,1)},empty:function(){return b.list.length==0},nextEvent:function(d){for(var g=0,e=b.list,l=e.length;g<l;++g)if(e[g]==d)return e[g+1];return null},min:function(){var d=b.list[0];return{x:d.vertex.x,y:d.ystar}},extractMin:function(){return b.list.shift()}};a.init();f.bottomSite=f.list.shift();for(var j=f.list.shift(),m,k,p,q,w,n,u,r,x;;){b.empty()||(m=b.min());if(j&&(b.empty()||j.y<m.y||j.y==m.y&&j.x<m.x)){k=a.leftBound(j);p=a.right(k);u=a.rightRegion(k);
x=i.bisect(u,j);n=a.createHalfEdge(x,"l");a.insert(k,n);if(r=i.intersect(k,n)){b.del(k);b.insert(k,r,i.distance(r,j))}k=n;n=a.createHalfEdge(x,"r");a.insert(k,n);(r=i.intersect(n,p))&&b.insert(n,r,i.distance(r,j));j=f.list.shift()}else if(b.empty())break;else{k=b.extractMin();q=a.left(k);p=a.right(k);w=a.right(p);u=a.leftRegion(k);n=a.rightRegion(p);r=k.vertex;i.endPoint(k.edge,k.side,r);i.endPoint(p.edge,p.side,r);a.del(k);b.del(p);a.del(p);k="l";if(u.y>n.y){k=u;u=n;n=k;k="r"}x=i.bisect(u,n);n=a.createHalfEdge(x,
k);a.insert(q,n);i.endPoint(x,A[k],r);if(r=i.intersect(q,n)){b.del(q);b.insert(q,r,i.distance(r,u))}(r=i.intersect(n,w))&&b.insert(n,r,i.distance(r,u))}}for(k=a.right(a.leftEnd);k!=a.rightEnd;k=a.right(k))h(k.edge)}d3.geom={};d3.geom.hull=function(c){if(c.length<3)return[];var h=c.length,f=h-1,a=[],i=[],b,j=0,m,k,p,q,w,n,u;for(b=1;b<h;++b)if(c[b][1]<c[j][1])j=b;else if(c[b][1]==c[j][1])j=c[b][0]<c[j][0]?b:j;for(b=0;b<h;++b)if(b!=j){k=c[b][1]-c[j][1];m=c[b][0]-c[j][0];a.push({angle:Math.atan2(k,m),
index:b})}a.sort(function(r,x){return r.angle-x.angle});u=a[0].angle;n=a[0].index;w=0;for(b=1;b<f;++b){h=a[b].index;if(u==a[b].angle){m=c[n][0]-c[j][0];k=c[n][1]-c[j][1];p=c[h][0]-c[j][0];q=c[h][1]-c[j][1];if(m*m+k*k>=p*p+q*q)a[b].index=-1;else{a[w].index=-1;u=a[b].angle;w=b;n=h}}else{u=a[b].angle;w=b;n=h}}i.push(j);for(h=b=0;b<2;++h)if(a[h].index!=-1){i.push(a[h].index);b++}for(j=i.length;h<f;++h)if(a[h].index!=-1){for(;!D(i[j-2],i[j-1],a[h].index,c);)--j;i[j++]=a[h].index}f=[];for(b=0;b<j;++b)f.push(c[i[b]]);
return f};d3.geom.polygon=function(c){c.area=function(){for(var h=0,f=c.length,a=c[f-1][0]*c[0][1],i=c[f-1][1]*c[0][0];++h<f;){a+=c[h-1][0]*c[h][1];i+=c[h-1][1]*c[h][0]}return(i-a)*0.5};c.clip=function(h){for(var f,a=-1,i=c.length,b,j,m=c[i-1],k,p,q;++a<i;){f=h.slice();h.length=0;k=c[a];p=f[(j=f.length)-1];for(b=-1;++b<j;){q=f[b];if(z(q,m,k)){z(p,m,k)||h.push(B(p,q,m,k));h.push(q)}else z(p,m,k)&&h.push(B(p,q,m,k));p=q}m=k}return h};return c};d3.geom.voronoi=function(c){var h=c.map(function(){return[]});
C(c,function(f){var a,i,b,j;if(f.a==1&&f.b>=0){a=f.ep.r;i=f.ep.l}else{a=f.ep.l;i=f.ep.r}if(f.a==1){b=a?a.y:-1E6;a=f.c-f.b*b;j=i?i.y:1E6;i=f.c-f.b*j}else{a=a?a.x:-1E6;b=f.c-f.a*a;i=i?i.x:1E6;j=f.c-f.a*i}a=[a,b];i=[i,j];h[f.region.l.index].push(a,i);h[f.region.r.index].push(a,i)});return h.map(function(f,a){var i=c[a][0],b=c[a][1];f.forEach(function(j){j.angle=Math.atan2(j[0]-i,j[1]-b)});return f.sort(function(j,m){return j.angle-m.angle}).filter(function(j,m){return!m||j.angle-f[m-1].angle>1.0E-10})})};
var A={l:"r",r:"l"};d3.geom.delaunay=function(c){var h=c.map(function(){return[]}),f=[];C(c,function(a){h[a.region.l.index].push(c[a.region.r.index])});h.forEach(function(a,i){var b=c[i],j=b[0],m=b[1];a.forEach(function(q){q.angle=Math.atan2(q[0]-j,q[1]-m)});a.sort(function(q,w){return q.angle-w.angle});for(var k=0,p=a.length-1;k<p;k++)f.push([b,a[k],a[k+1]])});return f}})();
